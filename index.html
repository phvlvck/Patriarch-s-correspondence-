<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ‡®ğŸ‡¶ Ø¯Ø±Ø¯Ø´Ø© Ø§Ù„Ø¹Ø±Ø§Ù‚ | Iraqi Chat</title>
    
    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <!-- CSS Files -->
    <link rel="stylesheet" href="style.css">
    
    <!-- Language Selector -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flag-icons/css/flag-icons.min.css">
    
    <!-- Ø­Ù„ Ù†Ù‡Ø§Ø¦ÙŠ Ù„Ù…Ø´ÙƒÙ„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ -->
    <style>
        /* Ø­Ù„ ÙÙˆØ±ÙŠ Ù„Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Cairo', sans-serif;
            background: #0f1e29;
            color: #e9edef;
            direction: rtl;
            height: 100vh;
            overflow: hidden;
        }
        
        #loadingScreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0f1e29 0%, #17212b 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease, visibility 0.5s ease;
        }
        
        #loadingScreen.hidden {
            opacity: 0;
            visibility: hidden;
        }
        
        .loading-content {
            text-align: center;
            max-width: 400px;
            padding: 40px;
            background: rgba(32, 44, 51, 0.9);
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5);
            border: 1px solid #2a3942;
        }
        
        .logo-animation {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .logo-animation i {
            font-size: 5rem;
            color: #0088cc;
            animation: pulse 2s infinite ease-in-out;
        }
        
        @keyframes pulse {
            0%, 100% { 
                transform: scale(1);
                color: #0088cc;
            }
            50% { 
                transform: scale(1.1);
                color: #00d4aa;
            }
        }
        
        .logo-text {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(45deg, #0088cc, #00d4aa);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .loading-progress {
            width: 100%;
            height: 6px;
            background: #2a3942;
            border-radius: 3px;
            margin: 30px 0;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #0088cc, #00d4aa);
            width: 0%;
            border-radius: 3px;
            transition: width 0.3s ease;
        }
        
        .loading-text {
            color: #8696a0;
            font-size: 1rem;
            margin-top: 20px;
        }
        
        /* Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØ­Ù…ÙŠÙ„ */
        #app {
            display: none;
            height: 100vh;
            overflow: hidden;
        }
        
        #app.ready {
            display: flex;
        }
    </style>
</head>
<body>
    <!-- Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ -->
    <div id="loadingScreen">
        <div class="loading-content">
            <div class="logo-animation">
                <i class="fas fa-comments"></i>
                <span class="logo-text">Ø¯Ø±Ø¯Ø´Ø© Ø§Ù„Ø¹Ø±Ø§Ù‚</span>
            </div>
            <p class="loading-text">ğŸš€ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚...</p>
            <div class="loading-progress">
                <div class="progress-bar" id="progressBar"></div>
            </div>
            <p id="loadingStatus">ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</p>
        </div>
    </div>

    <!-- Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ -->
    <div id="app">
        <!-- Language Selector -->
        <div class="language-selector">
            <div class="current-language" onclick="toggleLanguageMenu()">
                <span class="fi fi-iq" id="currentFlag"></span>
                <span id="currentLang">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</span>
                <i class="fas fa-chevron-down"></i>
            </div>
            <div class="language-menu" id="languageMenu">
                <div class="language-option" onclick="changeLanguage('ar')">
                    <span class="fi fi-iq"></span>
                    <span>Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</span>
                </div>
                <div class="language-option" onclick="changeLanguage('en')">
                    <span class="fi fi-us"></span>
                    <span>English</span>
                </div>
                <div class="language-option" onclick="changeLanguage('ku')">
                    <span class="fi fi-iq"></span>
                    <span>KurdÃ®</span>
                </div>
            </div>
        </div>

        <!-- Sidebar -->
        <div class="sidebar">
            <!-- Sidebar Header -->
            <div class="sidebar-header">
                <div class="user-profile" onclick="toggleUserMenu()">
                    <img id="userAvatar" src="https://api.dicebear.com/7.x/avataaars/svg?seed=Guest" alt="Avatar" class="avatar">
                    <div class="user-info">
                        <h3 id="userName">Ø²Ø§Ø¦Ø±</h3>
                        <p id="userStatus" class="status offline">ØºÙŠØ± Ù…ØªØµÙ„</p>
                    </div>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="user-menu" id="userMenu">
                    <div class="menu-item" onclick="showPage('profile')">
                        <i class="fas fa-user"></i>
                        <span>Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</span>
                    </div>
                    <div class="menu-item" onclick="showPage('settings')">
                        <i class="fas fa-cog"></i>
                        <span>Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</span>
                    </div>
                    <div class="menu-item" id="adminMenuItem" style="display: none;" onclick="showPage('admin')">
                        <i class="fas fa-shield-alt"></i>
                        <span>Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø´Ø±Ù</span>
                    </div>
                    <div class="menu-divider"></div>
                    <div class="menu-item logout" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i>
                        <span>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</span>
                    </div>
                </div>
                <button class="new-chat-btn" onclick="showNewChatModal()">
                    <i class="fas fa-edit"></i>
                </button>
            </div>

            <!-- Search Box -->
            <div class="search-container">
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" id="searchContacts" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ø­Ø§Ø¯Ø«Ø©..." oninput="searchChats()">
                </div>
            </div>

            <!-- Chat List -->
            <div class="chat-list" id="chatList">
                <!-- Ø³ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª Ù‡Ù†Ø§ -->
                <div class="chat-item" onclick="startChatWith('1')">
                    <div class="chat-avatar">
                        <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Ahmed" alt="Avatar" class="avatar">
                        <div class="online-indicator"></div>
                    </div>
                    <div class="chat-info">
                        <div class="chat-header">
                            <h4>Ø£Ø­Ù…Ø¯ Ø§Ù„Ø¹Ø±Ø§Ù‚ÙŠ</h4>
                            <span class="chat-time">Ø§Ù„ÙŠÙˆÙ…</span>
                        </div>
                        <div class="chat-preview">
                            <p>Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø¯Ø±Ø¯Ø´Ø© Ø§Ù„Ø¹Ø±Ø§Ù‚!</p>
                            <span class="unread-badge">2</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Bottom Navigation -->
            <div class="sidebar-footer">
                <button class="nav-btn active" onclick="showPage('chats')">
                    <i class="fas fa-comments"></i>
                    <span>Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª</span>
                </button>
                <button class="nav-btn" onclick="showPage('contacts')">
                    <i class="fas fa-users"></i>
                    <span>Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„</span>
                </button>
                <button class="nav-btn" onclick="showPage('discover')">
                    <i class="fas fa-compass"></i>
                    <span>Ø§ÙƒØªØ´Ù</span>
                </button>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Welcome Screen -->
            <div class="welcome-screen active" id="welcomeScreen">
                <div class="welcome-content">
                    <div class="welcome-logo">
                        <i class="fas fa-comments"></i>
                        <h1>Ø¯Ø±Ø¯Ø´Ø© Ø§Ù„Ø¹Ø±Ø§Ù‚</h1>
                    </div>
                    <p class="welcome-subtitle">
                        Ù…Ù†ØµØ© Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ø¹Ø±Ø§Ù‚ÙŠØ© Ø§Ù„Ø£ÙˆÙ„Ù‰ Ù„Ù„ØªØ¹Ø§Ø±Ù ÙˆØ§Ù„ØµØ¯Ø§Ù‚Ø§Øª
                    </p>
                    
                    <div class="auth-buttons">
                        <button class="auth-btn primary" onclick="showAuthModal('register')">
                            <i class="fas fa-user-plus"></i>
                            <span>Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</span>
                        </button>
                        <button class="auth-btn secondary" onclick="showAuthModal('login')">
                            <i class="fas fa-sign-in-alt"></i>
                            <span>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</span>
                        </button>
                    </div>

                    <div class="features">
                        <div class="feature">
                            <i class="fas fa-shield-alt"></i>
                            <h3>Ø¢Ù…Ù† ÙˆÙ…Ø­Ù…ÙŠ</h3>
                            <p>Ø­Ù…Ø§ÙŠØ© Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ù‡ÙŠ Ø£ÙˆÙ„ÙˆÙŠØªÙ†Ø§</p>
                        </div>
                        <div class="feature">
                            <i class="fas fa-bolt"></i>
                            <h3>Ø³Ø±ÙŠØ¹ ÙˆÙ…Ø¨Ø§Ø´Ø±</h3>
                            <p>Ø¯Ø±Ø¯Ø´Ø© ÙÙˆØ±ÙŠØ© Ø¨Ø¯ÙˆÙ† ØªØ£Ø®ÙŠØ±</p>
                        </div>
                        <div class="feature">
                            <i class="fas fa-users"></i>
                            <h3>ØªÙˆØ§ØµÙ„ Ø­Ù‚ÙŠÙ‚ÙŠ</h3>
                            <p>ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø£Ø´Ø®Ø§Øµ Ø­Ù‚ÙŠÙ‚ÙŠÙŠÙ†</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Chat Screen -->
            <div class="chat-screen" id="chatScreen">
                <div class="chat-header">
                    <button class="back-btn" onclick="closeChat()">
                        <i class="fas fa-arrow-right"></i>
                    </button>
                    <div class="chat-info">
                        <img id="chatAvatar" src="https://api.dicebear.com/7.x/avataaars/svg?seed=User" alt="" class="avatar">
                        <div class="chat-details">
                            <h3 id="chatUserName">Ù…Ø­Ø§Ø¯Ø«Ø© Ø¬Ø¯ÙŠØ¯Ø©</h3>
                            <p id="chatUserStatus" class="status online">Ù…ØªØµÙ„</p>
                        </div>
                    </div>
                    <div class="chat-actions">
                        <button class="action-btn" onclick="toggleChatInfo()">
                            <i class="fas fa-info-circle"></i>
                        </button>
                        <button class="action-btn" onclick="showChatMenu()">
                            <i class="fas fa-ellipsis-v"></i>
                        </button>
                    </div>
                </div>

                <div class="chat-messages" id="chatMessages">
                    <!-- Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø³ØªØ¸Ù‡Ø± Ù‡Ù†Ø§ -->
                    <div class="message received">
                        <div class="message-content">
                            Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø¯Ø±Ø¯Ø´Ø© Ø§Ù„Ø¹Ø±Ø§Ù‚! ğŸ‘‹
                        </div>
                        <div class="message-time">
                            10:00 Øµ
                        </div>
                    </div>
                </div>

                <div class="chat-input">
                    <div class="input-actions">
                        <button class="input-btn" onclick="toggleEmojiPicker()">
                            <i class="far fa-smile"></i>
                        </button>
                        <button class="input-btn" onclick="attachFile()">
                            <i class="fas fa-paperclip"></i>
                        </button>
                    </div>
                    <div class="message-input">
                        <textarea 
                            id="messageInput" 
                            placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„Ø©..." 
                            rows="1"
                            oninput="autoResize(this)"
                            onkeypress="handleKeyPress(event)"
                        ></textarea>
                    </div>
                    <div class="send-actions">
                        <button class="send-btn" onclick="sendMessage()">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Other Pages -->
            <div class="page" id="profilePage" style="display: none;">
                <div class="page-header">
                    <button class="back-btn" onclick="showPage('chats')">
                        <i class="fas fa-arrow-right"></i>
                    </button>
                    <h2>Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</h2>
                </div>
                <div class="page-content">
                    <!-- Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØµÙØ­Ø© -->
                </div>
            </div>
            
            <div class="page" id="contactsPage" style="display: none;">
                <div class="page-header">
                    <button class="back-btn" onclick="showPage('chats')">
                        <i class="fas fa-arrow-right"></i>
                    </button>
                    <h2>Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„</h2>
                </div>
                <div class="page-content">
                    <!-- Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØµÙØ­Ø© -->
                </div>
            </div>
        </div>
    </div>

    <!-- Auth Modal -->
    <div class="modal" id="authModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>
                <button class="close-btn" onclick="closeAuthModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="auth-tabs">
                    <button class="auth-tab active" id="loginTab" onclick="switchAuthTab('login')">
                        <i class="fas fa-sign-in-alt"></i>
                        <span>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</span>
                    </button>
                    <button class="auth-tab" id="registerTab" onclick="switchAuthTab('register')">
                        <i class="fas fa-user-plus"></i>
                        <span>Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</span>
                    </button>
                </div>

                <form id="loginForm" class="auth-form active">
                    <div class="form-group">
                        <label for="loginEmail">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
                        <input type="email" id="loginEmail" placeholder="example@iraqichat.com" required>
                    </div>
                    <div class="form-group">
                        <label for="loginPassword">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                        <input type="password" id="loginPassword" placeholder="********" required>
                        <button type="button" class="show-password" onclick="togglePassword('loginPassword')">
                            <i class="far fa-eye"></i>
                        </button>
                    </div>
                    <button type="submit" class="submit-btn">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
                </form>

                <form id="registerForm" class="auth-form">
                    <div class="form-group">
                        <label for="registerName">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</label>
                        <input type="text" id="registerName" placeholder="Ø£Ø­Ù…Ø¯ Ø§Ù„Ø¹Ø±Ø§Ù‚ÙŠ" required>
                    </div>
                    <div class="form-group">
                        <label for="registerUsername">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</label>
                        <input type="text" id="registerUsername" placeholder="ahmediraqi" required>
                    </div>
                    <div class="form-group">
                        <label for="registerEmail">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
                        <input type="email" id="registerEmail" placeholder="example@iraqichat.com" required>
                    </div>
                    <div class="form-group">
                        <label for="registerPassword">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                        <input type="password" id="registerPassword" placeholder="********" required minlength="6">
                        <button type="button" class="show-password" onclick="togglePassword('registerPassword')">
                            <i class="far fa-eye"></i>
                        </button>
                    </div>
                    <div class="form-group">
                        <label for="registerConfirmPassword">ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                        <input type="password" id="registerConfirmPassword" placeholder="********" required>
                    </div>
                    <div class="form-group">
                        <label for="registerAge">Ø§Ù„Ø¹Ù…Ø±</label>
                        <input type="number" id="registerAge" min="13" max="100" placeholder="25">
                    </div>
                    <div class="form-group">
                        <label for="registerCity">Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©</label>
                        <select id="registerCity">
                            <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©</option>
                            <option value="Ø¨ØºØ¯Ø§Ø¯">Ø¨ØºØ¯Ø§Ø¯</option>
                            <option value="Ø§Ù„Ø¨ØµØ±Ø©">Ø§Ù„Ø¨ØµØ±Ø©</option>
                            <option value="Ø§Ù„Ù…ÙˆØµÙ„">Ø§Ù„Ù…ÙˆØµÙ„</option>
                            <option value="Ø£Ø±Ø¨ÙŠÙ„">Ø£Ø±Ø¨ÙŠÙ„</option>
                            <option value="Ø§Ù„Ø³Ù„ÙŠÙ…Ø§Ù†ÙŠØ©">Ø§Ù„Ø³Ù„ÙŠÙ…Ø§Ù†ÙŠØ©</option>
                            <option value="ÙƒØ±Ø¨Ù„Ø§Ø¡">ÙƒØ±Ø¨Ù„Ø§Ø¡</option>
                            <option value="Ø§Ù„Ù†Ø¬Ù">Ø§Ù„Ù†Ø¬Ù</option>
                            <option value="Ø¨Ø§Ø¨Ù„">Ø¨Ø§Ø¨Ù„</option>
                        </select>
                    </div>
                    <button type="submit" class="submit-btn">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Notification Center -->
    <div class="notification-center" id="notificationCenter"></div>

    <!-- Connection Status -->
    <div class="connection-status" id="connectionStatus">
        <i class="fas fa-wifi"></i>
        <span>Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„...</span>
    </div>

    <!-- Scripts -->
    <script src="languages.js"></script>
    <script src="script.js"></script>
    
    <!-- Loader Script -->
    <script>
        // Ø­Ù„ Ù†Ù‡Ø§Ø¦ÙŠ Ù„Ù…Ø´ÙƒÙ„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸš€ Ø¨Ø¯Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚...');
            
            // ØªØ­Ø¯ÙŠØ« Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù…
            const progressBar = document.getElementById('progressBar');
            const loadingStatus = document.getElementById('loadingStatus');
            
            // Ù…Ø­Ø§ÙƒØ§Ø© Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ØªØ­Ù…ÙŠÙ„
            let progress = 0;
            const interval = setInterval(() => {
                progress += 5;
                progressBar.style.width = progress + '%';
                
                if (progress <= 25) {
                    loadingStatus.textContent = 'Ø¬Ø§Ø±ÙŠ ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...';
                } else if (progress <= 50) {
                    loadingStatus.textContent = 'Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©...';
                } else if (progress <= 75) {
                    loadingStatus.textContent = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø³ÙŠØ±ÙØ±...';
                } else {
                    loadingStatus.textContent = 'Ø¬Ø§Ø±ÙŠ Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚...';
                }
                
                if (progress >= 100) {
                    clearInterval(interval);
                    
                    // Ø¥Ø®ÙØ§Ø¡ Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø¨Ø¹Ø¯ ØªØ£Ø®ÙŠØ± Ù‚ØµÙŠØ±
                    setTimeout(() => {
                        const loadingScreen = document.getElementById('loadingScreen');
                        const app = document.getElementById('app');
                        
                        // Ø¥Ø®ÙØ§Ø¡ Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
                        loadingScreen.classList.add('hidden');
                        
                        // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
                        app.classList.add('ready');
                        
                        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
                        setTimeout(() => {
                            loadingScreen.style.display = 'none';
                            initializeApp();
                        }, 500);
                        
                        console.log('âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¨Ù†Ø¬Ø§Ø­');
                    }, 500);
                }
            }, 50);
        });
        
        function initializeApp() {
            // ØªÙ‡ÙŠØ¦Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù„ØºØ§Øª
            if (typeof LanguageManager !== 'undefined') {
                LanguageManager.init();
            }
            
            // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
            setupEventListeners();
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø³Ø§Ø¨Ù‚
            checkPreviousLogin();
            
            // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
            setupUI();
        }
        
        function setupEventListeners() {
            // Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©
            document.querySelectorAll('.auth-btn').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const type = this.classList.contains('primary') ? 'register' : 'login';
                    showAuthModal(type);
                });
            });
            
            // Ù†Ù…Ø§Ø°Ø¬ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©
            document.getElementById('loginForm')?.addEventListener('submit', function(e) {
                e.preventDefault();
                handleLogin();
            });
            
            document.getElementById('registerForm')?.addEventListener('submit', function(e) {
                e.preventDefault();
                handleRegister();
            });
            
            // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†ÙˆØ§ÙØ°
            document.querySelectorAll('.close-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const modal = this.closest('.modal');
                    if (modal) {
                        modal.classList.remove('show');
                    }
                });
            });
            
            // Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªÙ†Ù‚Ù„
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                });
            });
        }
        
        function setupUI() {
            // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù„ØºØ©
            const lang = localStorage.getItem('chat_language') || 'ar';
            changeLanguage(lang);
            
            // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø¯Ù†
            populateCities();
            
            // Ø¥Ø®ÙØ§Ø¡ Ø´Ø§Ø´Ø© Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© ÙÙŠ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©
            document.getElementById('chatScreen').style.display = 'none';
        }
        
        function checkPreviousLogin() {
            const user = localStorage.getItem('currentUser');
            if (user) {
                try {
                    const userData = JSON.parse(user);
                    updateUserInterface(userData);
                    document.querySelector('.welcome-screen').classList.remove('active');
                    document.getElementById('chatScreen').style.display = 'flex';
                } catch (e) {
                    console.error('Ø®Ø·Ø£ ÙÙŠ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:', e);
                    localStorage.removeItem('currentUser');
                }
            }
        }
        
        function updateUserInterface(user) {
            document.getElementById('userName').textContent = user.name;
            document.getElementById('userAvatar').src = user.avatar || 
                `https://api.dicebear.com/7.x/avataaars/svg?seed=${user.username}`;
            document.getElementById('userStatus').textContent = 'Ù…ØªØµÙ„';
            document.getElementById('userStatus').className = 'status online';
            
            if (user.is_admin) {
                document.getElementById('adminMenuItem').style.display = 'block';
            }
        }
        
        function populateCities() {
            const cities = [
                'Ø¨ØºØ¯Ø§Ø¯', 'Ø§Ù„Ø¨ØµØ±Ø©', 'Ø§Ù„Ù…ÙˆØµÙ„', 'Ø£Ø±Ø¨ÙŠÙ„', 'Ø§Ù„Ø³Ù„ÙŠÙ…Ø§Ù†ÙŠØ©',
                'ÙƒØ±Ø¨Ù„Ø§Ø¡', 'Ø§Ù„Ù†Ø¬Ù', 'Ø¨Ø§Ø¨Ù„', 'ÙˆØ§Ø³Ø·', 'ØµÙ„Ø§Ø­ Ø§Ù„Ø¯ÙŠÙ†',
                'Ø¯ÙŠØ§Ù„Ù‰', 'Ø°ÙŠ Ù‚Ø§Ø±', 'Ù…ÙŠØ³Ø§Ù†', 'Ø§Ù„Ù‚Ø§Ø¯Ø³ÙŠØ©', 'Ø§Ù„Ù…Ø«Ù†Ù‰',
                'Ø§Ù„Ø£Ù†Ø¨Ø§Ø±', 'Ù†ÙŠÙ†ÙˆÙ‰', 'Ø¯Ù‡ÙˆÙƒ', 'ÙƒØ±ÙƒÙˆÙƒ', 'Ø­Ù„Ø¨Ø¬Ø©'
            ];
            
            const select = document.getElementById('registerCity');
            if (select) {
                cities.forEach(city => {
                    const option = document.createElement('option');
                    option.value = city;
                    option.textContent = city;
                    select.appendChild(option);
                });
            }
        }
        
        function showAuthModal(type) {
            const modal = document.getElementById('authModal');
            modal.classList.add('show');
            switchAuthTab(type);
        }
        
        function closeAuthModal() {
            document.getElementById('authModal').classList.remove('show');
        }
        
        function switchAuthTab(tabName) {
            // Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ¨ÙˆÙŠØ¨
            document.querySelectorAll('.auth-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.getElementById(tabName + 'Tab').classList.add('active');
            
            // Ø§Ù„Ù†Ù…Ø§Ø°Ø¬
            document.querySelectorAll('.auth-form').forEach(form => {
                form.classList.remove('active');
            });
            document.getElementById(tabName + 'Form').classList.add('active');
            
            // Ø§Ù„Ø¹Ù†ÙˆØ§Ù†
            document.getElementById('modalTitle').textContent = 
                tabName === 'login' ? 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„' : 'Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨';
        }
        
        function togglePassword(inputId) {
            const input = document.getElementById(inputId);
            const icon = input.nextElementSibling?.querySelector('i');
            
            if (input.type === 'password') {
                input.type = 'text';
                if (icon) icon.className = 'far fa-eye-slash';
            } else {
                input.type = 'password';
                if (icon) icon.className = 'far fa-eye';
            }
        }
        
        function handleLogin() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            if (!email || !password) {
                showNotification('Ø®Ø·Ø£', 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„', 'error');
                return;
            }
            
            // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù…Ø­Ù„ÙŠØ§Ù‹ (Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±)
            const mockUser = {
                id: 'user_' + Date.now(),
                name: 'Ø£Ø­Ù…Ø¯ Ø§Ù„Ø¹Ø±Ø§Ù‚ÙŠ',
                username: 'ahmediraqi',
                email: email,
                avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=' + email,
                bio: 'Ù…Ø±Ø­Ø¨Ø§Ù‹! Ø£Ù†Ø§ Ø¬Ø¯ÙŠØ¯ ÙÙŠ Ø¯Ø±Ø¯Ø´Ø© Ø§Ù„Ø¹Ø±Ø§Ù‚',
                age: 28,
                city: 'Ø¨ØºØ¯Ø§Ø¯',
                is_admin: email === 'admin@iraqichat.com'
            };
            
            localStorage.setItem('currentUser', JSON.stringify(mockUser));
            updateUserInterface(mockUser);
            closeAuthModal();
            document.querySelector('.welcome-screen').classList.remove('active');
            document.getElementById('chatScreen').style.display = 'flex';
            
            showNotification('Ù†Ø¬Ø§Ø­', 'ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­', 'success');
        }
        
        function handleRegister() {
            const name = document.getElementById('registerName').value;
            const username = document.getElementById('registerUsername').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            const confirmPassword = document.getElementById('registerConfirmPassword').value;
            
            if (!name || !username || !email || !password) {
                showNotification('Ø®Ø·Ø£', 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„', 'error');
                return;
            }
            
            if (password !== confirmPassword) {
                showNotification('Ø®Ø·Ø£', 'ÙƒÙ„Ù…ØªØ§ Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± Ù…ØªØ·Ø§Ø¨Ù‚ØªÙŠÙ†', 'error');
                return;
            }
            
            // ØªØ³Ø¬ÙŠÙ„ Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯ Ù…Ø­Ù„ÙŠØ§Ù‹
            const newUser = {
                id: 'user_' + Date.now(),
                name: name,
                username: username,
                email: email,
                avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=' + username,
                bio: 'Ù…Ø±Ø­Ø¨Ø§Ù‹! Ø£Ù†Ø§ Ø¬Ø¯ÙŠØ¯ ÙÙŠ Ø¯Ø±Ø¯Ø´Ø© Ø§Ù„Ø¹Ø±Ø§Ù‚',
                age: document.getElementById('registerAge').value || null,
                city: document.getElementById('registerCity').value || '',
                is_admin: email === 'admin@iraqichat.com'
            };
            
            // Ø­ÙØ¸ ÙÙŠ localStorage
            let users = JSON.parse(localStorage.getItem('iraqi_chat_users') || '[]');
            users.push(newUser);
            localStorage.setItem('iraqi_chat_users', JSON.stringify(users));
            
            // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
            localStorage.setItem('currentUser', JSON.stringify(newUser));
            updateUserInterface(newUser);
            closeAuthModal();
            document.querySelector('.welcome-screen').classList.remove('active');
            document.getElementById('chatScreen').style.display = 'flex';
            
            showNotification('Ù†Ø¬Ø§Ø­', 'ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¨Ù†Ø¬Ø§Ø­', 'success');
        }
        
        function showNotification(title, message, type = 'info') {
            const notificationCenter = document.getElementById('notificationCenter');
            if (!notificationCenter) return;
            
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}"></i>
                <div class="notification-content">
                    <h4>${title}</h4>
                    <p>${message}</p>
                </div>
                <button class="notification-close" onclick="this.parentElement.remove()">
                    <i class="fas fa-times"></i>
                </button>
            `;
            
            notificationCenter.appendChild(notification);
            
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.remove();
                }
            }, 5000);
        }
        
        // Ø¯Ø§Ù„Ø§Øª ÙˆÙ‡Ù…ÙŠØ© Ù„Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø£Ø®Ø±Ù‰
        function toggleLanguageMenu() {
            const menu = document.getElementById('languageMenu');
            const current = document.querySelector('.current-language');
            menu.classList.toggle('show');
            current.classList.toggle('active');
        }
        
        function changeLanguage(lang) {
            localStorage.setItem('chat_language', lang);
            location.reload();
        }
        
        function toggleUserMenu() {
            document.getElementById('userMenu').classList.toggle('show');
        }
        
        function logout() {
            localStorage.removeItem('currentUser');
            location.reload();
        }
        
        function showPage(page) {
            // Ø¥Ø®ÙØ§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙØ­Ø§Øª
            document.querySelectorAll('.page').forEach(p => p.style.display = 'none');
            document.querySelector('.welcome-screen').classList.remove('active');
            document.getElementById('chatScreen').style.display = 'none';
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
            if (page === 'chats') {
                document.querySelector('.welcome-screen').classList.add('active');
            } else if (page === 'chat') {
                document.getElementById('chatScreen').style.display = 'flex';
            } else {
                document.getElementById(page + 'Page').style.display = 'block';
            }
        }
        
        function closeChat() {
            document.getElementById('chatScreen').style.display = 'none';
            document.querySelector('.welcome-screen').classList.add('active');
        }
        
        function startChatWith(userId) {
            // Ø¨Ø¯Ø¡ Ù…Ø­Ø§Ø¯Ø«Ø© Ø¬Ø¯ÙŠØ¯Ø©
            showPage('chat');
        }
        
        function sendMessage() {
            const input = document.getElementById('messageInput');
            const message = input.value.trim();
            
            if (message) {
                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¥Ù„Ù‰ Ø§Ù„Ø´Ø§Ø´Ø©
                const messagesDiv = document.getElementById('chatMessages');
                const messageDiv = document.createElement('div');
                messageDiv.className = 'message sent';
                messageDiv.innerHTML = `
                    <div class="message-content">${message}</div>
                    <div class="message-time">${new Date().toLocaleTimeString('ar-EG', {hour: '2-digit', minute:'2-digit'})}</div>
                `;
                
                messagesDiv.appendChild(messageDiv);
                messagesDiv.scrollTop = messagesDiv.scrollHeight;
                
                // Ù…Ø³Ø­ Ø§Ù„Ø­Ù‚Ù„
                input.value = '';
                input.style.height = 'auto';
            }
        }
        
        function autoResize(textarea) {
            textarea.style.height = 'auto';
            textarea.style.height = Math.min(textarea.scrollHeight, 120) + 'px';
        }
        
        function handleKeyPress(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendMessage();
            }
        }
        
        // Ø¬Ø¹Ù„ Ø§Ù„Ø¯ÙˆØ§Ù„ Ù…ØªØ§Ø­Ø© Ø¹Ø§Ù„Ù…ÙŠØ§Ù‹
        window.showNotification = showNotification;
        window.showAuthModal = showAuthModal;
        window.closeAuthModal = closeAuthModal;
        window.switchAuthTab = switchAuthTab;
        window.togglePassword = togglePassword;
        window.showPage = showPage;
        window.closeChat = closeChat;
        window.startChatWith = startChatWith;
        window.sendMessage = sendMessage;
        window.autoResize = autoResize;
        window.handleKeyPress = handleKeyPress;
    </script>
</body>
</html>
